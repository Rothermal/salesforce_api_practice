function buildFruits(a){for(var b=0;b<a.length;b++){var c=new Fruit(a[b],startingPrice);a[b]=c,updatePrice(c),user["inv"+c.name]=[]}}function buildDomFruits(a){$("#fruitContainer").empty();for(var b=0;b<a.length;b++){$("#fruitContainer").append("<div class='container col-sm-3 "+a[b].name.toLowerCase()+"-buy''></div>");var c=$("#fruitContainer").children().last();c.data("fruit",a[b].name),c.data("price",a[b].price),c.append("<p>"+a[b].name+"</p>"),c.append("<p class='fruit-price'>"+a[b].price.toFixed(2)+"</p>"),c.append("<p class='fruit-inv'>"+user["inv"+a[b].name].length+"</p>"),c.append("<button class='btn btn-warning fruit-button'>Buy</button>"),c.append("<button class='btn btn-warning sell-button'>Sell</button>"),a[b].element=c}updateBankDom()}function buildGameTypes(a){$("#gameType").empty();for(var b=0;b<a.length;b++)$("#gameType").append('<button type="button" data-text="'+a[b].name+'" data-dismiss="modal" class="btn btn-primary start">'+a[b].name+"</button>")}function updateBankDom(){console.log("t cash in bank dom",user.totalCash),$(".bank").empty();var a=$(".bank");a.text("$"+user.totalCash.toFixed(2))}function updateFruitDom(){for(var a=0;a<fruitArray.length;a++){var b=fruitArray[a];b.price=parseFloat((Math.round(100*b.price)/100).toFixed(2)),b.element.find(".fruit-price").text("$"+b.price.toFixed(2)),b.element.data("price",b.price)}postGameRound(fruitArray)}function updateGameVariables(a){var b=a;b||(b="Standard"),$.ajax({type:"GET",url:"/salesforce/gameSettings/"+b,success:function(a){console.log(a),a.starting_cash__c&&(startingCash=a.starting_cash__c),a.fruits__c&&(fruitArray=a.fruits__c.split(";")),a.game_length__c&&(gameRounds=a.game_length__c),a.game_interval__c&&(gameIntervalTime=a.game_interval__c),a.minswing__c&&(minSwing=a.minswing__c),a.maxswing__c&&(maxSwing=a.maxswing__c),a.starting_price__c&&(startingPrice=a.starting_price__c),console.log(minSwing),console.log(maxSwing),console.log(startingPrice),minPrice=.1*startingPrice,maxPrice=2*startingPrice-.01,user=new User,buildFruits(fruitArray),buildDomFruits(fruitArray),timer=setInterval(gameInterval,gameIntervalTime)}})}function updateInventory(){for(var a=0;a<fruitArray.length;a++)fruitArray[a].element.find(".fruit-inv").text(user["inv"+fruitArray[a].name].length)}function updatePrice(a){var b=randomNumber(minSwing,maxSwing),c=randomNumber(1,2);1==c&&(b=-b),b/=100,a.price+=b,a.price>maxPrice&&(a.price=maxPrice),a.price<minPrice&&(a.price=minPrice)}function Fruit(a,b){this.name=a,this.price=b}function User(){this.totalCash=startingCash}function enable(){$("#fruitContainer").on("click",".fruit-button",buyFruit),$("#fruitContainer").on("click",".sell-button",sellFruit),$("#gameType").on("click",".start",startGame)}function disable(){clearInterval(timer),$(".sell-button").prop("disabled",!0),$(".fruit-button").prop("disabled",!0),gameOver()}function startGame(){var a=$(this).data("text");getGameId(),updateGameVariables(a)}function gameInterval(){if(gameRounds--,0===gameRounds)disable(),console.log("Game Over");else{for(var a=0;a<fruitArray.length;a++)updatePrice(fruitArray[a]);updateFruitDom()}}function getGameId(){$.ajax({type:"GET",url:"salesforce/start",success:function(a){console.log("game id",a)}})}function buyFruit(){var a=$(this).parent().data("fruit"),b=$(this).parent().data("price"),c=$(this);user.totalCash>=b&&(user.totalCash-=b,$(this).prop("disabled",!0),postFruit(a,b,c),updateBankDom())}function sellFruit(){var a=$(this).parent().data("fruit"),b=$(this).parent().data("price"),c=$(this);if(user["inv"+a].length>0){var d=user["inv"+a].splice(0,1);user.totalCash+=b,$(this).prop("disabled",!0),updateFruit(d,b,c),updateBankDom()}}function postFruit(a,b,c){var d={name:a,price:b};$.ajax({type:"POST",url:"/salesforce/buyFruit",data:d,success:function(b){user["inv"+a].push(b),updateInventory(),c.prop("disabled",!1)}})}function updateFruit(a,b,c){var d={id:a,price:b};$.ajax({type:"PUT",url:"/salesforce/sellFruit",data:d,success:function(a){console.log("sell fruit response",a),c&&c.prop("disabled",!1),updateInventory()}})}function gameOver(){console.log("selling all fruit"),console.log(fruitArray);for(var a="",b=0,c=0;c<fruitArray.length;c++)for(var d=0;d<user["inv"+fruitArray[c].name].length;d++)a=user["inv"+fruitArray[c].name][d],b=fruitArray[c].price,user.totalCash+=b,updateFruit(a,b,null);updateBankDom(),$("#fruitContainer").empty()}function postGameRound(a){console.log(a)}function randomNumber(a,b){return Math.floor(Math.random()*(1+b-a)+a)}function getGameType(){$.ajax({type:"GET",url:"/salesforce/gameType",success:function(a){console.log(a),buildGameTypes(a)}})}var fruitArray=["Apples","Oranges","Bananas","Pears"],startingPrice=5,minSwing=1,maxSwing=50,minPrice=.1*startingPrice,maxPrice=2*startingPrice-.01,gameIntervalTime=5e3,gameRounds=60,startingCash=100,timer,user;$(document).ready(function(){init()});var init=function(){console.log("jquery initalized"),enable(),getGameType()};
//# sourceMappingURL=client.map